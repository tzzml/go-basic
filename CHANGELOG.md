# 更新日志 (Changelog)

所有值得注意的项目更改都将记录在此文件中。

## [未发布]

### 新增功能

#### PRINT 语句增强
- **分隔符支持**:
  - 分号 `;` 实现紧凑输出（值之间不添加空格）
  - 逗号 `,` 添加空格分隔
  - 末尾分隔符（分号或逗号）抑制换行
- **示例**: `PRINT "A("; I; ") = "; A(I)` 输出 `A(0) = 10`

#### INPUT 语句增强
- **多变量输入**: `INPUT X, Y, Z` 支持为多个变量读取输入
- **提示字符串**: `INPUT "Enter name:", NAME$` 支持自定义提示
- **字符串变量**: 支持以 `$` 结尾的字符串变量名
- **显示序号**: 多变量输入时显示 `[1]`, `[2]` 等序号提示

#### 内置函数
- 新增多个数学函数：`ABS`, `SIN`, `COS`, `TAN`, `INT`, `SQR`, `LOG`, `EXP`, `RND`
- 所有函数名大小写不敏感

#### 大小写不敏感
- **变量名**: `myVar`, `MYVAR`, `myvar` 都指向同一变量
- **函数名**: `sin(30)`, `SIN(30)`, `Sin(30)` 等效
- 符合 BASIC 传统行为

#### 交互模式增强
- 新增 `FORMAT` 命令：重新格式化程序（重新编号行号、大写关键字）
- 新增 `EDIT` 命令：编辑指定行号的内容
- 新增 `DELETE` 命令：删除指定行号
- 改进 `LOAD` 命令：支持加载 .bas 文件

#### 注释增强
- **单引号注释**: 支持 `'` 作为注释标记（GW-BASIC/QuickBASIC 风格）
- **两种注释风格**: REM 和 `'` 功能完全相同，可自由选择
- **行尾注释**: 支持在语句后添加注释（需使用冒号 `:` 分隔）
- **示例**: `A = 10: ' 这是行尾注释`

#### 多语句行支持
- **冒号分隔符**: 支持同一行中的多个语句，使用冒号 `:` 分隔
- **空行支持**: 支持只有行号没有语句的空行
- **示例**: `A = 10: B = 20: PRINT A + B`

### 改进

#### 运算符
- **MOD 运算符**: 新增取模运算 `10 MOD 3` 结果为 1
- **NOT 逻辑运算**: 新增逻辑非运算 `NOT A > 10`

#### 比较运算符修复
- 修复 `>=` 和 `<=` 运算符匹配顺序，确保正确解析
- 之前 `SCORE >= 90` 会被错误解析，现已修复

#### 数组
- 改进数组访问的边界检查和错误提示

### 文档
- 更新 README.md，添加详细的功能说明和示例
- 更新 FEATURES.md，添加完整的语言特性参考
- 新增 CHANGELOG.md 记录所有改进
- 添加注释和多语句行的完整文档

### 示例程序
- 更新 `samples/08_forloop.bas` 展示直角三角形乘法表
- 新增 `samples/12_operators.bas` 展示 MOD 和 NOT 运算符
- 新增 `samples/13_functions.bas` 展示所有内置数学函数
- 新增 `samples/14_scientific_notation.bas` 展示科学计数法
- 新增 `samples/15_input_advanced.bas` 展示 INPUT 高级用法
- 新增 `samples/16_extensions.bas` 展示扩展特性
- 新增 `samples/17_comments.bas` 展示 REM 和单引号两种注释风格
- 更新所有示例以使用新的分隔符功能

### 技术改进

#### 解析器
- 改进 PEG 语法定义，修复多处类型转换问题
- 优化 `PrintArgList` 和 `IdentifierList` 的序列访问
- 支持跨行的 IF...THEN...ELSE...END IF 语句
- 新增 `SingleQuoteCommentStmt` 规则支持单引号注释
- 新增 `StatementList` 规则支持冒号分隔的多语句行
- 改进 `Line` 规则支持空行（只有行号没有语句）

#### AST
- `PrintStmt` 新增 `Separators` 字段保存分隔符信息
- 改进类型安全性和错误处理

#### 解释器
- 实现 `normalizeName()` 方法统一处理大小写转换
- 改进变量、数组、函数名的大小写不敏感处理

## [1.0.0] - 初始版本

### 基础功能
- PRINT 语句输出
- 变量赋值（LET 语句）
- IF...THEN...ELSE 条件判断
- FOR...NEXT 循环
- GOTO/GOSUB/RETURN 跳转
- DIM 数组声明
- INPUT 用户输入
- REM 注释
- END 程序结束

### 运算符
- 算术运算：`+`, `-`, `*`, `/`, `^`
- 比较运算：`=`, `<>`, `>`, `<`, `>=`, `<=`
- 逻辑运算：`AND`, `OR`

### 数据类型
- 数字（浮点数）
- 字符串字面量

### 程序结构
- 行号格式
- 交互模式
- 文件执行模式
